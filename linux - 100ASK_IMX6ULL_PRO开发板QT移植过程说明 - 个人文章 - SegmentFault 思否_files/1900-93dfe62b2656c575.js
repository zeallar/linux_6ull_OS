"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1900],{60205:function(e,t){t.Z={src:"https://static.segmentfault.com/main_site_next/5ae3ab99/_next/static/media/bg-219.cbec47c3.svg",height:9,width:21,blurWidth:0,blurHeight:0}},54255:function(e,t,n){var i=n(11527),l=n(50959),a=n(69991);let s=e=>{let{tags:t=[],className:n="",site:l,isSite:s=!1,source:c=""}=e,r=(null==t?void 0:t.length)>0?(0,i.jsx)("div",{className:"d-flex flex-wrap align-items-center ".concat(n),children:(0,i.jsxs)("div",{className:"m-n1 d-flex flex-wrap align-items-center",children:[!s&&(null==l?void 0:l.thumbnail_url)&&(0,i.jsx)("a",{className:"m-1",href:l.url,target:"_blank",children:(0,i.jsx)("img",{src:l.thumbnail_url,alt:l.name,width:"24",height:"24",style:{borderRadius:"0.1875rem",verticalAlign:"top"}})}),t.map(e=>(0,i.jsx)(a.Z,{data:e,source:c},e.id))]})}):null;return r};t.Z=l.memo(s)},97344:function(e,t,n){n.d(t,{Z:function(){return K}});var i=n(11527),l=n(50959),a=n(75778),s=n(23970),c=n(74637),r=n.n(c),d=n(30721),o=n(88072);let m=e=>{let{type:t,licence:n}=e;return(0,i.jsx)("div",{className:"font-size-14 text-secondary text-center mt-3 mb-5",children:(0===t||1===t)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:"本作品系原创，"}),"sa"===n?(0,i.jsx)("a",{target:"_blank",className:"text-secondary",href:"https://creativecommons.org/licenses/by-nc-sa/4.0/",children:"采用《署名-非商业性使用-相同方式共享 4.0 国际》许可协议"}):"nd"===n?(0,i.jsx)("a",{target:"_blank",className:"text-secondary",href:"https://segmentfault.com/tos#sec-licence-4",children:"作者保留所有权利，未经作者允许，禁止转载和演绎"}):(0,i.jsx)("a",{target:"_blank",className:"text-secondary",href:"https://creativecommons.org/licenses/by-nc-nd/4.0/",children:"采用《署名-非商业性使用-禁止演绎 4.0 国际》许可协议"})]})})};var u=l.memo(m),h=n(79852),v=n(34940),x=n(40941),g=n(87710),p=n(44868);let f=e=>{let{blog:t}=e,[n,a]=(0,l.useState)((null==t?void 0:t.is_followed)||0),s=async()=>!!(0,p.bg)()&&(await (0,g.ZNR)({id:t.id,type:"blog",isFollow:n?0:1}),a(!n),!0);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("hr",{className:"mb-0"}),(0,i.jsxs)(h.Z,{className:"pt-4 align-items-center",children:[(0,i.jsxs)(v.Z,{className:"d-flex align-items-center col-12 col-md w-0",children:[(0,i.jsx)("a",{href:null==t?void 0:t.url,children:(0,i.jsx)("img",{className:"me-3 rounded",width:"64",height:"64",src:(null==t?void 0:t.thumbnail_url)||"https://image-static.segmentfault.com/383/303/3833030929-5ffd15fc110ab","aria-hidden":"true"})}),(0,i.jsxs)("div",{className:"w-100",children:[(0,i.jsx)("a",{href:null==t?void 0:t.url,className:"text-body",children:(0,i.jsx)("h5",{className:"mb-0",children:null==t?void 0:t.name})}),(null==t?void 0:t.excerpt)&&(0,i.jsx)("div",{className:"text-truncate-1 text-secondary mt-2",children:null==t?void 0:t.excerpt})]})]}),(0,i.jsx)(v.Z,{className:"col-md-90 col-12 mt-md-0 mt-3",id:"followUser",children:(0,i.jsx)("div",{className:"d-grid",children:(0,i.jsx)(x.Z,{onClick:s,children:n?"已关注":"关注专栏"})})})]})]})};var j=l.memo(f),y=n(4270),b=n.n(y),N=n(94071),w=n(50111),k=n(78661),_=n(23312),S=n(49485);let Z=e=>{let{realRed:t=0,read:n=0,created:l=0,modified:a=0,id:s,actions:c=[],initPage:d,isEditor:o,memberActions:m}=e,u=()=>{S.Am.hide()},h=(e,t)=>{switch(t){case"report":k.ZP.confirm({content:"string"==typeof e?e:"举报成功"});break;case"hide-setting":case"delete":(0,S.Am)("string"==typeof e?e:""),null==d||d();break;case"reject":u(),null==d||d();break;default:"string"==typeof e&&(0,S.Am)("string"==typeof e?e:""),null==d||d()}};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"text-secondary font-size-14 mt-3 mb-5 d-flex flex-wrap justify-content-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("span",{children:["阅读 ",(0,S.Ae)(n),o&&t>0&&"（UV ".concat((0,S.Ae)(t),"）")]}),(0,i.jsx)("span",{className:"split-dot"}),l!==a&&a>l?(0,i.jsx)(N.Z,{placement:"top",overlay:(0,i.jsxs)(w.Z,{id:"tip-top",children:["发布于 ",(0,i.jsx)("span",{children:(0,S.dq)(l)})]}),children:(0,i.jsx)("a",{href:"/a/".concat(s,"/revision"),className:"text-secondary",children:(0,i.jsxs)("time",{dateTime:r().unix(l).toISOString(),itemProp:"datePublished",children:["更新于 ",(0,S.dq)(a)]})})}):(0,i.jsx)("a",{href:"/a/".concat(s,"/revision"),className:"text-secondary",children:(0,i.jsxs)("time",{dateTime:r().unix(l).toISOString(),itemProp:"datePublished",children:["发布于 ",(0,S.dq)(l)]})})]}),(0,i.jsx)("div",{className:"operation text-end",children:(0,i.jsx)(_.Z,{id:s,actions:c,type:"article",onCallBack:h,member_actions:m})})]})})},I=(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(b(),{id:"986f121867ae534",children:".operation .dropdown-toggle::after{display:none}"})}),A=e=>(0,i.jsxs)(i.Fragment,{children:[I,(0,i.jsx)(Z,{...e})]});var E=l.memo(A),F=n(84875),C=n.n(F);n(45393);var q=n(54498),L=n.n(q),O=n(18318);r().locale("zh-cn"),r().extend(L());let T=e=>{var t,n,l,a,s,c,d,o,m,u,h,v,x,p,f,j;let{title:y,user:b,id:k,created:_,modified:Z,initPage:I,actions:A,member_actions:E,lang:F,langs:q,ipAddress:L=""}=e,T=()=>{(null==A?void 0:A.find(e=>"recommend"===e.action))?(0,g.U6L)(k).then(()=>{(0,S.Am)("推荐已提交，等待审核"),I()}):(0,g.AVM)(k).then(()=>{I()})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h1",{className:"h2 mb-3",children:(0,i.jsx)("a",{href:"/a/".concat(k),className:"text-body",children:y})}),(0,i.jsxs)("div",{className:"d-flex flex-wrap mb-4",children:[(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsxs)("a",{href:null==b?void 0:b.url,className:"d-flex align-items-center",children:[(0,i.jsx)("picture",{className:"me-2",children:(0,i.jsx)(O.Z,{src:null==b?void 0:b.avatar_url,headdress:null==b?void 0:b.headdress_worn,width:32,height:32})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"d-flex align-items-center",children:[(0,i.jsx)("strong",{className:"align-self-center",itemProp:"name",children:null==b?void 0:b.name}),(0,i.jsx)("ul",{className:"list-inline mb-0 authentication-info ms-1 font-size-14",children:!!(null==b?void 0:null===(c=b.user_auth)||void 0===c?void 0:c.is_auth)&&(0,i.jsx)("li",{className:"list-inline-item",children:(null==b?void 0:null===(d=b.user_auth)||void 0===d?void 0:d.info)?(0,i.jsx)(N.Z,{placement:"top",overlay:(0,i.jsx)(w.Z,{id:"tooltip-top",children:null==b?void 0:null===(o=b.user_auth)||void 0===o?void 0:o.info}),children:(0,i.jsx)("i",{className:C()("fas fa-badge-check",(null==b?void 0:null===(m=b.user_auth)||void 0===m?void 0:m.type)===1?"text-info":"text-warning")})}):(0,i.jsx)("i",{className:C()("fas fa-badge-check",(null==b?void 0:null===(u=b.user_auth)||void 0===u?void 0:u.type)===1?"text-info":"text-warning")})})})]}),(0,i.jsxs)("div",{className:"font-size-14 rank-wrap text-secondary",children:[(0,i.jsx)("span",{className:"me-1",style:{color:"#BF7158",fontWeight:"bold"},children:(0,S.Ae)(null==b?void 0:b.rank)}),(null==b?void 0:null===(h=b.summary_badges)||void 0===h?void 0:h.gold)?(0,i.jsxs)("span",{className:"d-inline-block me-1",children:[(0,i.jsx)("i",{className:"medal-circle fas fa-circle",style:{color:"#FFDA23"}}),null==b?void 0:null===(v=b.summary_badges)||void 0===v?void 0:v.gold]}):null,(null==b?void 0:null===(x=b.summary_badges)||void 0===x?void 0:x.silver)?(0,i.jsxs)("span",{className:"d-inline-block me-1",children:[(0,i.jsx)("i",{className:"medal-circle fas fa-circle",style:{color:"#C5C5C5"}}),null==b?void 0:null===(p=b.summary_badges)||void 0===p?void 0:p.silver]}):null,(null==b?void 0:null===(f=b.summary_badges)||void 0===f?void 0:f.bronze)?(0,i.jsxs)("span",{className:"d-inline-block",children:[(0,i.jsx)("i",{className:"medal-circle fas fa-circle",style:{color:"#CD9A62"}}),null==b?void 0:null===(j=b.summary_badges)||void 0===j?void 0:j.bronze]}):null]})]})]}),(0,i.jsx)("div",{className:"vertical-divider"}),(()=>{let e=(0,i.jsxs)("a",{href:"/a/".concat(k,"/revision"),className:"text-secondary font-size-14",children:[(0,i.jsx)("div",{children:"发布于"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("time",{dateTime:r().unix(_).toISOString(),itemProp:"datePublished",children:(0,S.dq)(_)}),L&&(0,i.jsxs)("span",{children:[" ",L]})]})]});return _!==Z&&Z>_?(0,i.jsx)(N.Z,{placement:"top",overlay:(0,i.jsx)(w.Z,{id:"top",children:(0,i.jsxs)("span",{className:"",children:["更新于 ",(0,S.dq)(Z)]})}),children:e}):e})()]}),(0,i.jsxs)("div",{className:"d-flex flex-column justify-content-center font-size-14",children:[(0,i.jsxs)("div",{className:"d-flex align-items-baseline",children:[(null===(t=null==E?void 0:E.find(e=>"edit"===e.action))||void 0===t?void 0:t.name)?(0,i.jsx)("a",{href:"/a/".concat(k,"/edit"),className:"ms-3",children:"编辑"}):null,(null===(n=null==A?void 0:A.find(e=>"recommend"===e.action))||void 0===n?void 0:n.name)||(null===(l=null==A?void 0:A.find(e=>"cancel-recommend"===e.action))||void 0===l?void 0:l.name)?(0,i.jsx)("a",{href:"###",className:"ms-3",onClick:e=>{e.preventDefault(),T()},children:(null===(a=null==A?void 0:A.find(e=>"recommend"===e.action))||void 0===a?void 0:a.name)||(null===(s=null==A?void 0:A.find(e=>"cancel-recommend"===e.action))||void 0===s?void 0:s.name)}):null,(null==q?void 0:q.length)>0&&(0,i.jsxs)("a",{href:"en"===F?"/a/".concat(k):"/a/".concat(k,"/en"),className:"d-flex align-items-center ms-3 lh-1",children:[(0,i.jsx)("i",{className:"far fa-language"}),(0,i.jsx)("span",{className:"ms-1",children:"en"===F?"中文":"English"})]})]}),(0,i.jsx)("div",{children:" "})]})]})]})};var P=n(54255);let z=e=>{let{originUrl:t="",type:n}=e;return(0,i.jsx)("div",{className:"bg-light my-4 p-3",children:(0,i.jsxs)("a",{className:"d-flex align-items-center text-body",href:t,target:"_blank",rel:"nofollow",children:[(0,i.jsx)("div",{className:"d-flex align-items-center bg-secondary justify-content-center me-3 rounded px-3",style:{width:"48px",height:"48px"},children:(0,i.jsx)("i",{className:"far fa-file-lines fa-lg text-white"})}),(0,i.jsxs)("div",{className:"media-body w-100",children:[(0,i.jsx)("div",{className:"text-body mb-0 fw-bold",children:(0,i.jsxs)("span",{style:{color:"#000"},children:["本文系",2===n?"转载":"翻译","，阅读原文"]})}),(0,i.jsx)("div",{className:"font-size-13 text-secondary text-truncate-1 w-75",children:(0,i.jsx)("small",{style:{wordBreak:"break-word"},children:t})})]})]})})};var H=l.memo(z),M=n(25487),B=n(57898);let U=e=>{let{visible:t,payUrl:n}=e;return t?(0,i.jsxs)(M.Z,{variant:"warning",className:"mb-4",children:[(0,i.jsx)("p",{children:"还差一步，支付后即可公开展示。"}),(0,i.jsx)("div",{children:(0,i.jsx)(B.Z,{variant:"danger",href:n,children:"支付 ￥100"})})]}):null};var $=l.memo(U),D=n(94328);class V{buildNavTitle(){let e,t;for(t=1;t<=3;t++)if(this.$article.querySelectorAll("h"+t).length){e=3===t?this.$article.querySelectorAll("h"+t):this.$article.querySelectorAll("h".concat(t,", h").concat(t+1));break}let n=0,i=0;(null==e?void 0:e.length)&&e.forEach(e=>{if(e.nodeName.substr(1,1)===t){n++,e.setAttribute("id","item-".concat(n));let t=document.createElement("a");t.className="list-group-item list-group-item-action border-0 text-secondary text-truncate-1",t.setAttribute("href","#item-".concat(n)),t.innerText=e.textContent.replace(/</gi,"&lt;").replace(/>/gi,"&gt;"),this.$parent.appendChild(t)}else{i++,e.setAttribute("id","item-".concat(n,"-").concat(i));let t=document.createElement("a");t.className="list-group-item list-group-item-action border-0 text-secondary text-truncate-1 nav2",t.setAttribute("href","#item-".concat(n,"-").concat(i)),t.innerText=e.textContent.replace(/</gi,"&lt;").replace(/>/gi,"&gt;"),this.$parent.appendChild(t)}});let l=[],a=[],s=[];null==e||e.forEach(e=>{switch(e.tagName){case"H1":l.push(e.tagName);break;case"H2":a.push(e.tagName);break;case"H3":s.push(e.tagName)}});let c=!1;return l.length>=2?c=!0:0===l.length&&a.length>=2?c=!0:0===l.length&&0===a.length&&s.length>=2&&(c=!0),!!e&&!!c&&!!e}init(){if(!this.$parent)return;let e=this.buildNavTitle(),t=document.querySelector("#articleNavCard");if(e)t&&(t.style.display="block"),this.callback instanceof Function&&this.callback();else{var n;null==t||null===(n=t.parentNode)||void 0===n||n.removeChild(t);return}let i=document.querySelectorAll("#articleNavCard a");i.forEach(e=>{e.addEventListener("click",e=>{i.forEach(t=>{var n,i;t.classList.add("text-secondary"),t.classList.remove("text-primary");let l=e.currentTarget;null==l||null===(n=l.classList)||void 0===n||n.remove("text-secondary"),null==l||null===(i=l.classList)||void 0===i||i.add("text-primary")})})})}constructor(e,t,n){this.$parent=e,this.$article=t,this.callback=n,this.init()}}let R=!1;var W=e=>{if(null==e?void 0:e.length)for(let n=0;n<e.length;n++){var t;let i=(null===(t=null==document?void 0:document.getElementById(e[n].substr(1)))||void 0===t?void 0:t.getBoundingClientRect().top)||0;if(i>10&&i<80){if(n>6&&n%7==1){let t=e.length>16?232*Math.floor(n/7):(e.length-8)*29;R=!0;let i=document.getElementById("collapseTarget");i&&(i.scrollTop=t)}else if(n<8&&n>=0&&R){R=!1;let e=document.getElementById("collapseTarget");e&&(e.scrollTop=0)}let t=document.querySelectorAll("div[data-article-nav] a");t.length&&(t.forEach(e=>{e.classList.remove("text-primary"),e.classList.add("text-secondary")}),t[n].classList.remove("text-secondary"),t[n].classList.add("text-primary"))}}},G=n(3502);let J=e=>{var t,c,m;let{detail:h,actionData:v,actions:x,initPage:p,imageUrl:f,isEditor:y,isAuthor:b,memberActions:N,articleHtml:w,lang:k,payInfo:_,isBaiduOxApp:S=!1,visibleActions:Z=!0}=e,[I,A]=(0,l.useState)((0,s.jU)()?"":"https://static.segmentfault.com/main_site_next/5ae3ab99"),{article:F,blog:C,description:q,site:L}=h,[O,z]=(0,l.useState)(!1),[M,B]=(0,l.useState)((0,s.jU)()?(null===(t=document.querySelector(".article.fmt"))||void 0===t?void 0:t.innerHTML)||(null==F?void 0:F.parsed_text):w),U=(0,D.zG)(M),R=(0,l.useRef)(),J=(0,s.I0)();return(0,s.jU)()&&!O&&(window.articleHtml=(null===(m=document.querySelector(".article.fmt"))||void 0===m?void 0:m.innerHTML)||""),(0,l.useEffect)(()=>{if(M){if(R.current instanceof HTMLElement){let e=null==R?void 0:R.current.getElementsByTagName("a"),t=e.length;for(let n=0;n<t;n++)e[n].target="_blank"}}else{let e=(0,G.Z)();e.errorEvent({eventName:"articleContent"}),(0,g.mxb)({aid:F.id,pure:1}).then(e=>{J({type:"articleDetail/saveArticleHtml",payload:{id:F.id,parsed_text:null==e?void 0:e.parsed_text}}),B(null==e?void 0:e.parsed_text)})}},[M]),(0,l.useEffect)(()=>{z(!0),A(window.publicPath||""),J({type:"articleDetail/saveArticleHtml",payload:{id:F.id,parsed_text:window.articleHtml}})},[]),(0,l.useEffect)(()=>{(null==F?void 0:F.parsed_text)&&B(F.parsed_text)},[null==F?void 0:F.parsed_text]),(0,l.useEffect)(()=>{if(M){let e=document.querySelectorAll("#article-nav-list a");if(e.length>0){let e=document.querySelector("#article-nav-list");e&&(e.innerHTML="")}new V(document.querySelector("#article-nav-list"),document.querySelector("article.article-content"),()=>{var e,t;let n=[],i=document.querySelectorAll("#article-nav-list a");for(let e=0;e<i.length;e++){let t=i[e].getAttribute("href")||"";n.push(t)}n.length&&(null==i||null===(e=i[0])||void 0===e||e.classList.add("text-primary"),null==i||null===(t=i[0])||void 0===t||t.classList.remove("text-secondary"),window.addEventListener("scroll",()=>W(n)))})}return()=>{window.removeEventListener("scroll",()=>W(""))}},[M]),(0,l.useEffect)(()=>{U&&R&&R.current&&M&&U.run(R.current)},[U,R,M]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.ql,{children:[(0,i.jsx)("meta",{name:"twitter:card",content:f?"summary_large_image":"summary"}),(0,i.jsx)("meta",{name:"twitter:image",content:f?"https://segmentfault.com".concat(f):"".concat(I,"touch-icon.png")}),(0,i.jsx)("meta",{name:"twitter:site",content:"@segment_fault"}),(0,i.jsx)("meta",{name:"twitter:creator",content:"@segmentfault"}),(0,i.jsx)("meta",{name:"twitter:title",content:null==F?void 0:F.title}),(0,i.jsx)("meta",{name:"og:type",content:"article"}),(0,i.jsx)("meta",{name:"og:image",content:f?"https://segmentfault.com".concat(f):"".concat(I,"touch-icon.png")}),(0,i.jsx)("meta",{name:"og:title",content:null==F?void 0:F.title}),(0,i.jsx)("meta",{name:"og:description",content:q}),(0,i.jsx)("meta",{name:"og:url",content:"https://segmentfault.com/a/".concat(null==F?void 0:F.id)}),(0,i.jsx)("meta",{name:"og:site_name",content:"SegmentFault 思否"}),(0,i.jsx)("meta",{name:"msvalidate.01",content:"2C018C53297C8388F3E7052F5E9CA6AF"}),(0,i.jsx)("meta",{name:"event-object",value:'{"current": ["article", ["'.concat(null==F?void 0:F.id,'"]], "root": ["article", "').concat(null==F?void 0:F.id,'"]}'),id:"SFEventObject"}),(0,i.jsx)("link",{rel:"canonical",href:"https://segmentfault.com/a/".concat(null==F?void 0:F.id)}),(0,i.jsx)("script",{type:"application/ld+json",dangerouslySetInnerHTML:{__html:'{\n            "@context": "https://schema.org",\n            "@type": "Article",\n            "mainEntityOfPage": {\n              "@type": "WebPage",\n              "@id": "https://google.com/article"\n            },\n            "name": '.concat(JSON.stringify((null==F?void 0:F.title)||""),',\n            "headline": ').concat(JSON.stringify((null==F?void 0:F.title)||""),',\n            "image": "').concat((null==F?void 0:F.cover)?null==F?void 0:F.cover:f||"".concat(I,"touch-icon.png"),'",\n            "datePublished": "').concat(r().unix(null==F?void 0:F.created).toISOString(),'",\n            "dateModified": "').concat(r().unix((null==F?void 0:F.created)>(null==F?void 0:F.modified)?null==F?void 0:F.created:null==F?void 0:F.modified).toISOString(),'",\n            "url": "https://segmentfault.com/a/').concat(null==F?void 0:F.id,'",\n            "author": {\n              "@type": "Person",\n              "name": ').concat(JSON.stringify(null==F?void 0:null===(c=F.user)||void 0===c?void 0:c.name),'\n            },\n            "publisher": {\n              "@type": "Organization",\n              "name": "SegmentFault",\n              "logo": {\n                "@type": "ImageObject",\n                "url":\n                  "https://assets.segmentfault.com/v-5fc4b0b2/global/img/static/touch-icon.png"\n              }\n            }\n          }')}})]}),(0,i.jsxs)(a.Z,{className:"mb-4",children:[(null==F?void 0:F.cover)&&(0,i.jsx)(a.Z.Img,{variant:"top",src:n(60205).Z.src,className:"w-100 rounded-top",style:{background:"no-repeat center url(".concat(F.cover,")"),backgroundSize:"cover"},alt:"头图"}),(0,i.jsxs)(a.Z.Body,{className:"p-lg-30 position-relative",children:[(0,i.jsx)(T,{title:null==F?void 0:F.title,user:null==F?void 0:F.user,id:null==F?void 0:F.id,created:null==F?void 0:F.created,modified:null==F?void 0:F.modified,initPage:p,actions:x,member_actions:N,langs:null==F?void 0:F.langs,lang:k,ipAddress:null==F?void 0:F.ip_address}),(0,i.jsx)(d.Z,{name:"25"}),(0,i.jsx)($,{visible:(null==_?void 0:_.paid)===!1,payUrl:null==_?void 0:_.pay_url,id:null==F?void 0:F.id}),(0,i.jsx)("article",{className:"article fmt article-content ",dangerouslySetInnerHTML:{__html:M},ref:R}),!S&&(0,i.jsx)(P.Z,{tags:null==F?void 0:F.tags,isSite:!1,site:L}),(null==F?void 0:F.article_type)>1&&(0,i.jsx)(H,{originUrl:null==F?void 0:F.origin_url,type:null==F?void 0:F.article_type}),(0,i.jsx)("div",{className:"my-4",children:(0,i.jsx)(d.Z,{name:"3"})}),(0,i.jsx)(E,{realRed:null==F?void 0:F.real_unique_views,read:null==F?void 0:F.real_views,created:null==F?void 0:F.created,modified:null==F?void 0:F.modified,id:null==F?void 0:F.id,actions:x,initPage:p,isEditor:y,memberActions:N}),Z&&(0,i.jsx)(o.Z,{id:null==F?void 0:F.id,title:null==F?void 0:F.title,actionData:{...v},banner:null==F?void 0:F.cover,isAuthor:b,mode:"btnGroup",source:"article"}),(0,i.jsx)(u,{type:null==F?void 0:F.article_type,licence:null==C?void 0:C.licence}),(null==C?void 0:C.id)&&!S&&(0,i.jsx)(j,{blog:C})]})]})]})};var K=l.memo(J)},58658:function(e,t,n){var i=n(11527);n(50959);var l=n(61122),a=n(23970);let s=e=>{let{data:t,className:n="",isBaiduOxApp:a=!1}=e;return a?null:(0,i.jsxs)(l.Z,{className:"font-size-14 px-0 my-0 position-relative ".concat(n),bsPrefix:"breadcrumb bg-transparent",style:{zIndex:1},children:[(0,i.jsx)(l.Z.Item,{href:"/",children:"首页"}),t.map((e,n)=>e.name?(0,i.jsx)(l.Z.Item,{href:e.url,active:t.length===n+1,children:e.name},e.url):null)]})};t.Z=(0,a.$j)(e=>{let{global:t}=e;return{isBaiduOxApp:t.isBaiduOxApp}})(s)},69991:function(e,t,n){var i=n(11527),l=n(50959);let a=e=>{let{data:t,className:n="",source:l="",isSingle:a=!1}=e;return(0,i.jsxs)("a",{href:"product"===l?null==t?void 0:t.product_url:l?"".concat(t.url,"/").concat(l):t.url,className:"".concat(a?"":"m-1"," badge-tag ").concat(t.isGray?"badge-gray-tag":""," ").concat(n),children:[(null==t?void 0:t.icon_url)&&(0,i.jsx)("img",{src:t.icon_url,alt:"",width:"16",height:"16",className:"me-1"}),t.name]},t.id)};t.Z=l.memo(a)},23312:function(e,t,n){var i=n(11527),l=n(50959),a=n(16983),s=n(87989),c=n(23970),r=n(76734),d=n(78661),o=n(87710);let m=e=>{var t;let{id:n,type:c,actions:m=[],member_actions:u=[],onCallBack:h,sessionUser:v,className:x,qid:g,questionDetail:p,tagName:f}=e,[j,y]=(0,l.useState)({visable:!1,action:"",actionName:""}),{site:b={},question:{is_site:N=1}={}}="question"===c&&p[n]||{},[w,k]=(0,l.useState)(!1),[_,S]=(0,l.useState)(!1),[Z,I]=(0,l.useState)(!1),A=e=>{(0,o.dFf)({id:n,type:c,handle:e}).then(e=>{h(e)})},E=async e=>{if("report"===j.action){let t;let i=await (0,o.Hjr)({object_id:n,...e}).catch(e=>{t=null==e?void 0:e.object_id});h(i||t,j.action);return}if("seo"===j.action||"hide-setting"===j.action){h("",j.action);return}if("delete"===j.action){(0,o.qF1)({id:n,type:c,...e}).then(e=>{h(e,j.action)});return}(0,o.dFf)({id:n,type:c,handle:j.action,...e}).then(e=>{h(e,j.action)})},F=()=>{d.ZP.confirm({title:"社区维基",content:'转为<a href="'.concat(s.n5,'" target="_blank"> 社区维基 </a>后，该内容署名将捐献给社区，且后续投票不再影响你的声望，确定继续？'),onSuccess:()=>{A("wiki")}})};return(0,i.jsxs)("div",{className:x,children:[(u.length>0||m.length>0)&&(0,i.jsxs)(i.Fragment,{children:[u.filter(e=>"edit"===e.type).map(e=>{let t;switch(c){case"article":t="/a/".concat(n,"/edit");break;case"question":t="/q/".concat(n,"/edit");break;case"answer":t="/q/".concat(g,"/a-").concat(n,"/edit");break;case"product":t="/product/".concat(n,"/edit");break;case"product-score":t="/product/".concat(g,"/r-").concat(n,"/edit");break;case"tag":t="/t/".concat(encodeURIComponent(f),"/edit");break;case"event":t="/events/".concat(n,"/edit")}return(0,i.jsx)("a",{className:"text-secondary ".concat(c,"-edit"),href:t,children:(0,i.jsx)("span",{children:"编辑"})},e.name)}),((null===(t=null==u?void 0:u.filter(e=>"edit"!==e.type))||void 0===t?void 0:t.length)>0||(null==m?void 0:m.length)>0)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"split-dot"}),(0,i.jsx)("div",{className:"d-inline-block",children:(0,i.jsxs)(a.Z,{children:[(0,i.jsx)(a.Z.Toggle,{as:r.Z,className:"text-secondary",id:"operate-manage-toggle",children:(0,i.jsx)("span",{children:"操作"})}),(0,i.jsxs)(a.Z.Menu,{children:[u.filter(e=>"edit"!==e.type).map((e,t)=>"reason"===e.type?(0,i.jsx)(a.Z.Item,{onClick:()=>{y({action:e.action,visable:!0,actionName:e.name})},children:e.name},e.name+t):"wiki"===e.action?(0,i.jsx)(a.Z.Item,{onClick:()=>F(),children:e.name},e.name+t):"put"===e.type?(0,i.jsx)(a.Z.Item,{onClick:()=>A(e.action),children:e.name},e.name+t):void 0),m.length>0&&u.filter(e=>"edit"!==e.type).length>0&&(0,i.jsx)(a.Z.Divider,{}),m.map((e,t)=>{if("edit"===e.type){let l;switch(c){case"article":l="/a/".concat(n,"/edit");break;case"question":l="/q/".concat(n,"/edit");break;case"answer":l="/q/".concat(g,"/a-").concat(n,"/edit");break;case"product":l="/product/".concat(n,"/edit");break;case"product-score":l="/product/".concat(g,"/r-").concat(n,"/edit")}return(0,i.jsx)(a.Z.Item,{href:l,children:e.name},e.name+t)}return"reason"===e.type?(0,i.jsx)(a.Z.Item,{onClick:()=>{y({action:e.action,visable:!0,actionName:e.name})},children:e.name},e.name+t):"put"===e.type?(0,i.jsx)(a.Z.Item,{onClick:()=>A(e.action),children:e.name},e.name+t):"site"===e.type?(0,i.jsx)(a.Z.Item,{onClick:()=>{k(!0),y({...j,action:e.action})},children:e.name},e.name+t):"seo"===e.type?(0,i.jsx)(a.Z.Item,{onClick:()=>{S(!0),y({...j,action:e.action})},children:e.name},e.name+t):"hide"===e.type?(0,i.jsx)(a.Z.Item,{onClick:()=>{I(!0),y({...j,action:e.action})},children:e.name},e.name+t):(0,i.jsx)(a.Z.Item,{children:e.name},e.name+t)})]})]})})]})]}),(u.length>0||(null==m?void 0:m.length)>0)&&(0,i.jsx)("span",{className:"split-dot"}),v&&(0,i.jsx)("a",{className:"text-secondary",href:"###",onClick:e=>{e.preventDefault(),y({action:"report",visable:!0,actionName:"举报"})},children:(0,i.jsx)("span",{children:"举报"})}),j.visable&&(0,i.jsx)(d.rK,{id:n,isShow:!0,action:j.action,actionName:j.actionName,setModalStatus:y,onOk:E}),w&&(0,i.jsx)(d.B3,{isShow:!0,setModalStatus:k,callback:E,siteId:null==b?void 0:b.id,isSite:N}),(0,i.jsx)(d.uP,{id:n,isShow:_,setModalStatus:S,callBack:E}),(0,i.jsx)(d.h8,{id:n,isShow:Z,setModalStatus:I,callBack:E})]})};t.Z=(0,c.$j)(e=>{let{global:t,question:n}=e;return{sessionUser:t.sessionUser,questionDetail:n.questionDetail}})(l.memo(m))},94328:function(e,t,n){n.d(t,{zG:function(){return s}});var i=n(50959),l=n(23970);class a{run(e){this.wrap=e,this.allImgs=e.querySelectorAll("article img"),this.bindImgClick(),this.bindEvent()}createViewer(){var e;if(!(0,l.jU)()||this.viewFrame)return;this.viewFrame=document.createElement("div"),this.viewFrame.className="is-active ImageView p-4",this.viewFrame.style.display="none",this.viewFrame.innerHTML='<div class="ImageView-inner" style="overflow: auto;">\n      <img src="" class="ImageView-img" referrerpolicy="no-referrer" alt="preview" style="max-width: 100%; max-height: 100%;">\n    </div>';let t=document.body||document.documentElement;t.appendChild(this.viewFrame),null===(e=this.viewFrame)||void 0===e||e.addEventListener("click",()=>{this.viewFrame&&(this.viewFrame.style.display="none",this.viewFrame.classList.remove("fadeIn"),this.viewFrame.classList.add("fadeOut"))})}bindEvent(){this.allImgs.forEach(e=>{let t=e.getAttribute("src")||e.getAttribute("data-src")||"";(null==t?void 0:t.startsWith("/img/"))&&!(null==t?void 0:t.match(/\/view$/))&&(t.indexOf("?")>-1?t=t.substring(0,t.indexOf("?"))+"/view"+t.substring(t.indexOf("?")):t+="/view"),t&&this.imgArr.push(t)});let e=document.body||document.documentElement;e.addEventListener("keydown",e=>{var t,n,i,l,a,s;(null===(t=this.viewFrame)||void 0===t?void 0:t.style.display)!=="none"&&(37===e.keyCode&&this.curIndex>0&&(this.curIndex=this.curIndex-1,null===(i=null===(l=this.viewFrame)||void 0===l?void 0:l.querySelector("img"))||void 0===i||i.setAttribute("src",this.imgArr[this.curIndex])),39===e.keyCode&&this.curIndex<(null===(n=this.imgArr)||void 0===n?void 0:n.length)-1&&(this.curIndex=this.curIndex+1,null===(a=null===(s=this.viewFrame)||void 0===s?void 0:s.querySelector("img"))||void 0===a||a.setAttribute("src",this.imgArr[this.curIndex])))})}bindImgClick(){this.allImgs.forEach((e,t)=>{e.addEventListener("click",()=>{let n=(null==e?void 0:e.getAttribute("src"))||(null==e?void 0:e.getAttribute("data-src"));this.curIndex=t;let i=null==e?void 0:e.parentElement,l=0;for(let e=0;e<5;e++){if((null==i?void 0:i.tagName)==="A"){l+=1;break}i=null==i?void 0:i.parentElement}if(!(l>0)&&(null==n?void 0:n.startsWith("/img/"))&&!(null==n?void 0:n.match(/\/view$/))){var a;n.indexOf("?")>-1?n=n.substring(0,n.indexOf("?"))+"/view"+n.substring(n.indexOf("?")):n+="/view";let e=null===(a=this.viewFrame)||void 0===a?void 0:a.querySelector("img");e&&(e.setAttribute("src",n),e.addEventListener("load",()=>{this.viewFrame&&(this.viewFrame.style.display="block",this.viewFrame.classList.remove("fadeOut"),this.viewFrame.classList.add("fadeIn"))}))}})})}constructor(){this.curIndex=1,this.imgArr=[],this.createViewer()}}let s=e=>{let[t,n]=(0,i.useState)();return(0,i.useEffect)(()=>{e&&!t&&e.match(/<img/)&&n(new a)},[e,t]),t},c=new a;t.ZP=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;c.run(e)}}}]);